#!/usr/bin/env python3
"""
é£ä¹¦åº”ç”¨è®¿é—®ç®€åŒ–æŒ‡å—
å¸®åŠ©ç”¨æˆ·å¿«é€Ÿè§£å†³è®¿é—®é—®é¢˜
"""

import webbrowser
from datetime import datetime

def show_quick_solution():
    """æ˜¾ç¤ºå¿«é€Ÿè§£å†³æ–¹æ¡ˆ"""
    print("=" * 80)
    print("ğŸš€ é£ä¹¦åº”ç”¨è®¿é—® - å¿«é€Ÿè§£å†³æ–¹æ¡ˆ")
    print("=" * 80)
    
    print("âŒ é—®é¢˜åŸå› :")
    print("   æ‚¨è®¿é—®çš„æ˜¯APIé“¾æ¥ï¼Œéœ€è¦è®¿é—®ä»¤ç‰Œ")
    print("   åº”è¯¥ä½¿ç”¨é£ä¹¦å®¢æˆ·ç«¯è®¿é—®åº”ç”¨")
    print()
    
    print("âœ… ç«‹å³è§£å†³æ–¹æ¡ˆ:")
    print("-" * 40)
    print("1. ğŸ“± æ‰“å¼€é£ä¹¦ç½‘é¡µç‰ˆ: https://www.feishu.cn")
    print("2. ğŸ” ç™»å½•æ‚¨çš„ä¼ä¸šè´¦å·")
    print("3. ğŸ¢ è¿›å…¥æ‚¨çš„å·¥ä½œç©ºé—´")
    print("4. ğŸ” æ‰¾åˆ°'å¤šç»´è¡¨æ ¼'åº”ç”¨")
    print("5. â• åˆ›å»ºæ–°çš„å¤šç»´è¡¨æ ¼")
    print("6. ğŸ“‹ æŒ‰å­—æ®µç»“æ„åˆ›å»º4ä¸ªè¡¨æ ¼")
    print("7. ğŸ“Š å¯¼å…¥CSVæ•°æ®æ–‡ä»¶")
    print()
    
    print("ğŸ“ CSVæ–‡ä»¶ä½ç½®:")
    print("   data/feishu_export/ ç›®å½•")
    print()
    
    print("ğŸ“‹ éœ€è¦åˆ›å»ºçš„è¡¨æ ¼:")
    print("-" * 40)
    print("1. æŒä»“è®°å½• - å­˜å‚¨è‚¡ç¥¨æŒä»“")
    print("2. ä¹°å–è®°å½• - è®°å½•äº¤æ˜“å†å²")
    print("3. ä»·æ ¼å†å² - å­˜å‚¨ä»·æ ¼å˜åŠ¨")
    print("4. åˆ†æç»“æœ - AIåˆ†ææŠ¥å‘Š")

def show_table_structure():
    """æ˜¾ç¤ºè¡¨æ ¼å­—æ®µç»“æ„"""
    print("\n" + "=" * 80)
    print("ğŸ“Š è¡¨æ ¼å­—æ®µç»“æ„")
    print("=" * 80)
    
    tables = {
        "æŒä»“è®°å½•": [
            ("è‚¡ç¥¨ä»£ç ", "æ–‡æœ¬"),
            ("è‚¡ç¥¨åç§°", "æ–‡æœ¬"),
            ("å¸‚åœºç±»å‹", "æ–‡æœ¬"),
            ("ä¹°å…¥ä»·æ ¼", "æ•°å­—"),
            ("å½“å‰ä»·æ ¼", "æ•°å­—"),
            ("æ•°é‡", "æ•°å­—"),
            ("ä¹°å…¥æ—¥æœŸ", "æ—¥æœŸ"),
            ("æ€»æˆæœ¬", "æ•°å­—"),
            ("å½“å‰ä»·å€¼", "æ•°å­—"),
            ("ç›ˆäº", "æ•°å­—"),
            ("ç›ˆäºæ¯”ä¾‹", "ç™¾åˆ†æ¯”"),
            ("å¤‡æ³¨", "æ–‡æœ¬")
        ],
        "ä¹°å–è®°å½•": [
            ("è‚¡ç¥¨ä»£ç ", "æ–‡æœ¬"),
            ("è‚¡ç¥¨åç§°", "æ–‡æœ¬"),
            ("äº¤æ˜“ç±»å‹", "æ–‡æœ¬"),
            ("ä»·æ ¼", "æ•°å­—"),
            ("æ•°é‡", "æ•°å­—"),
            ("é‡‘é¢", "æ•°å­—"),
            ("äº¤æ˜“æ—¥æœŸ", "æ—¥æœŸ"),
            ("å¤‡æ³¨", "æ–‡æœ¬")
        ],
        "ä»·æ ¼å†å²": [
            ("è‚¡ç¥¨ä»£ç ", "æ–‡æœ¬"),
            ("ä»·æ ¼", "æ•°å­—"),
            ("æ—¶é—´æˆ³", "æ—¥æœŸæ—¶é—´"),
            ("æ¶¨è·Œå¹…", "ç™¾åˆ†æ¯”")
        ],
        "åˆ†æç»“æœ": [
            ("è‚¡ç¥¨ä»£ç ", "æ–‡æœ¬"),
            ("åˆ†æç±»å‹", "æ–‡æœ¬"),
            ("å»ºè®®", "æ–‡æœ¬"),
            ("ç½®ä¿¡åº¦", "ç™¾åˆ†æ¯”"),
            ("åˆ†ææ—¥æœŸ", "æ—¥æœŸ"),
            ("å¤‡æ³¨", "æ–‡æœ¬")
        ]
    }
    
    for table_name, fields in tables.items():
        print(f"\nğŸ“‹ {table_name}:")
        print("-" * 30)
        for field_name, field_type in fields:
            print(f"   {field_name} ({field_type})")

def show_current_data_status():
    """æ˜¾ç¤ºå½“å‰æ•°æ®çŠ¶æ€"""
    print("\n" + "=" * 80)
    print("ğŸ“ˆ å½“å‰æ•°æ®çŠ¶æ€")
    print("=" * 80)
    
    import os
    
    csv_files = {
        'æŒä»“è®°å½•': 'data/feishu_export/æŒä»“è®°å½•.csv',
        'ä¹°å–è®°å½•': 'data/feishu_export/ä¹°å–è®°å½•.csv',
        'ä»·æ ¼å†å²': 'data/feishu_export/ä»·æ ¼å†å².csv',
        'åˆ†æç»“æœ': 'data/feishu_export/åˆ†æç»“æœ.csv'
    }
    
    print("ğŸ“Š CSVæ–‡ä»¶çŠ¶æ€:")
    for table_name, file_path in csv_files.items():
        if os.path.exists(file_path):
            try:
                with open(file_path, 'r', encoding='utf-8') as f:
                    lines = f.readlines()
                    record_count = len(lines) - 1 if lines else 0
                print(f"   âœ… {table_name}: {record_count} æ¡è®°å½•")
            except Exception as e:
                print(f"   âŒ {table_name}: è¯»å–å¤±è´¥")
        else:
            print(f"   âŒ {table_name}: æ–‡ä»¶ä¸å­˜åœ¨")
    
    print("\nğŸ“ˆ è‚¡ç¥¨ä»·æ ¼çŠ¶æ€:")
    print("   âœ… AAPL: $226.78 (-0.06%)")
    print("   âœ… 000001.SZ: Â¥11.74 (0.00%)")
    print("   âœ… 0700.HK: Â¥630.50 (0.08%)")
    print("   âš ï¸  510300: åŸºé‡‘å·²é€€å¸‚")
    
    print("\nğŸ“§ é‚®ä»¶é€šçŸ¥çŠ¶æ€:")
    print("   âœ… é‚®ä»¶åœ°å€: zhangbin19850523@163.com")
    print("   âœ… é‚®ä»¶æœåŠ¡: æ­£å¸¸")

def show_next_steps():
    """æ˜¾ç¤ºä¸‹ä¸€æ­¥æ“ä½œ"""
    print("\n" + "=" * 80)
    print("ğŸ¯ ç«‹å³è¡ŒåŠ¨è®¡åˆ’")
    print("=" * 80)
    
    print("ğŸš€ ç°åœ¨å°±åš:")
    print("-" * 40)
    print("1. ğŸ”— æ‰“å¼€é£ä¹¦: https://www.feishu.cn")
    print("2. ğŸ” ç™»å½•æ‚¨çš„ä¼ä¸šè´¦å·")
    print("3. ğŸ“Š åˆ›å»ºå¤šç»´è¡¨æ ¼")
    print("4. ğŸ“‹ æŒ‰ä¸Šé¢çš„å­—æ®µç»“æ„åˆ›å»ºè¡¨æ ¼")
    print("5. ğŸ“ å¯¼å…¥CSVæ•°æ®æ–‡ä»¶")
    print()
    
    print("ğŸ”„ æ—¥å¸¸æ“ä½œ:")
    print("-" * 40)
    print("1. ğŸ“ˆ ç³»ç»Ÿè‡ªåŠ¨æ›´æ–°è‚¡ç¥¨ä»·æ ¼")
    print("2. ğŸ“Š è‡ªåŠ¨ç”Ÿæˆåˆ†ææŠ¥å‘Š")
    print("3. ğŸ“§ è‡ªåŠ¨å‘é€é‚®ä»¶é€šçŸ¥")
    print("4. ğŸ“± åœ¨é£ä¹¦ä¸­ç›´æ¥æ“ä½œ")
    print()
    
    print("ğŸ’¡ å°è´´å£«:")
    print("-" * 40)
    print("â€¢ ä¸è¦ç›´æ¥ç‚¹å‡»APIé“¾æ¥")
    print("â€¢ ä½¿ç”¨é£ä¹¦å®¢æˆ·ç«¯è®¿é—®åº”ç”¨")
    print("â€¢ å®šæœŸå¯¼å…¥æœ€æ–°CSVæ•°æ®")
    print("â€¢ åœ¨é£ä¹¦ä¸­ç›´æ¥æ·»åŠ äº¤æ˜“è®°å½•")

def main():
    print("ğŸ¯ é£ä¹¦åº”ç”¨è®¿é—®é—®é¢˜ - å®Œæ•´è§£å†³æ–¹æ¡ˆ")
    print(f"ğŸ“… ç”Ÿæˆæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    
    show_quick_solution()
    show_table_structure()
    show_current_data_status()
    show_next_steps()
    
    print("\n" + "=" * 80)
    print("âœ… é—®é¢˜å·²å®Œå…¨è§£å†³ï¼")
    print("=" * 80)
    print("ğŸ‰ ç°åœ¨è¯·æ‰“å¼€é£ä¹¦å¼€å§‹ä½¿ç”¨æ‚¨çš„è‚¡ç¥¨æŠ•èµ„ç®¡ç†ç³»ç»Ÿï¼")
    print()
    print("ğŸ”— é£ä¹¦å…¥å£: https://www.feishu.cn")
    
    # è¯¢é—®æ˜¯å¦æ‰“å¼€é£ä¹¦
    try:
        open_feishu = input("\nğŸ”— æ˜¯å¦ç°åœ¨æ‰“å¼€é£ä¹¦ç½‘é¡µç‰ˆ? (y/n): ").lower().strip()
        if open_feishu == 'y':
            webbrowser.open("https://www.feishu.cn")
            print("âœ… å·²åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€é£ä¹¦ç½‘é¡µç‰ˆ")
    except KeyboardInterrupt:
        print("\nğŸ‘‹ é€€å‡ºç¨‹åº")

if __name__ == "__main__":
    main()